// Production-Ready DBML Schema
// Docs: https://dbml.dbdiagram.io/docs

// ================================
// MAIN ENTITIES
// ================================

// ================================
// AUTH (Supabase-managed)
// ================================
Table auth_users {
  id uuid [pk, note: 'Unique ID of the user in Supabase Auth']
  aud varchar(255) [note: 'Audience claim']
  role varchar(50) [note: 'Role claim for RLS policies']
  email varchar(255) [note: 'User email address']
  email_confirmed_at timestamptz
  phone varchar(20)
  phone_confirmed_at timestamptz
  confirmed_at timestamptz
  last_sign_in_at timestamptz
  app_metadata jsonb [note: 'Includes provider info: { provider, providers[] }']
  user_metadata jsonb [note: 'Custom editable user metadata']
  identities jsonb [note: 'List of linked provider identities']
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]
  is_anonymous boolean [default: false, not null]

  note: 'This table is managed by Supabase; do not write to it directly.'
}

// ================================
// PROFILE (Application user layer)
// ================================
Table profiles {
  id uuid [pk, note: 'References Supabase auth.users.id']
  email varchar(255) [not null, note: 'Gets initialized by trigger on sign up, should not be modifiable']
  full_name varchar(255)
  display_name varchar(100)
  avatar_url varchar(255) [note: 'URL to the user\'s avatar']
  birth_date date
  phone varchar(20) 
  locale varchar(10) [default: 'en-CA', not null]
  timezone varchar(50) [default: 'America/Toronto', not null]
  two_factor_enabled boolean [default: false, not null]
  last_active_at timestamptz
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    email [unique, name: 'uq_profiles_email']
  }
}

// ================================
// PLATFORM ADMIN
// ================================
Enum admin_role_enum {
  super_admin
  moderator
  support
}

Table admins {
  id uuid [pk, note: 'References profiles.id']
  role admin_role_enum [not null]
  permissions jsonb
  assigned_at timestamptz [default: `now()`, not null]
  notes text
}

// ================================
// ORGANIZATION
// ================================
Enum organization_nature_enum {
  public
  private
}

Enum organization_type_enum {
  club
  municipality
  city
  association
}

Enum country_enum {
  Canada
  "United States"
}

Table organizations {
  id uuid [pk, default: `gen_random_uuid()`]
  owner_id uuid [note: 'Primary account owner']
  name varchar(255) [not null]
  nature organization_nature_enum [not null, note: "public vs privée"]

  email varchar(255) [unique, not null]
  phone varchar(20)
  slug varchar(255) [unique, not null, note: 'URL-friendly identifier']

  address varchar(255)
  city varchar(100)
  country country_enum
  postal_code varchar(20)

  type organization_type_enum
  description text
  website varchar(255)
  
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    name [name: 'idx_org_name']
  }
}

// ================================
// ORGANIZATION MEMBER
// ================================
Enum role_enum {
  admin
  staff
  player
  coach
  owner
}

Table organization_members {
  id uuid [pk, default: `gen_random_uuid()`]
  user_id uuid [not null]
  organization_id uuid [not null]
  role role_enum [not null]
  permissions jsonb
  joined_at timestamptz [default: `now()`, not null]
  left_at timestamptz
  invited_by uuid
  
  indexes {
    (user_id, organization_id) [unique]
  }
}

// ================================
// PLAYER
// ================================
Enum gender_enum {
  M
  F
  O
  prefer_not_to_say
}

Enum playing_hand_enum {
  right
  left
  both
}

Table players {
  id uuid [pk, note: 'References profiles.id']
  username varchar(50) [unique, not null]
  bio text
  gender gender_enum
  playing_hand playing_hand_enum
  max_travel_distance int
  reputation_score decimal(5,2) [default: 0.00, not null]
  rating_count int [default: 0, not null]
  verified boolean [default: false, not null]
}

Enum day_enum {
  monday
  tuesday
  wednesday
  thursday
  friday
  saturday
  sunday
}

Enum period_enum {
  morning   [note: 'Typically 6am–12pm']
  afternoon [note: 'Typically 12pm–6pm']
  evening   [note: 'Typically 6pm–12am']
}

Table player_availabilities {
  id uuid [pk, default: `gen_random_uuid()`]
  player_id uuid [not null]
  day day_enum [not null]
  period period_enum [not null]
  is_active boolean [not null, default: true]
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    player_id [name: 'idx_player_availabilities_player']
    day [name: 'idx_player_availabilities_day']
    period [name: 'idx_player_availabilities_period']
    (player_id, day, period) [unique, name: 'uq_player_availabilities_player_day_period']
  }

  note: 'Stores player availabilities for scheduling matches.'
}

// ================================
// SPORTS
// ================================
Table sports {
  id uuid [pk, default: `gen_random_uuid()`]
  name varchar(100) [not null, unique]
  slug varchar(100) [not null, unique]
  description text
  is_active boolean [not null, default: true]
  attributes jsonb [note: 'Optional metadata (e.g., common court dimensions, tags)']
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    name [name: 'idx_sports_name']
    is_active [name: 'idx_sports_is_active']
  }

  note: 'Defines supported sports within the application.'
}

// ================================
// PLAYER SPORTS
// ================================
Table play_styles {
  id uuid [pk, default: `gen_random_uuid()`]
  sport_id uuid [not null]
  name varchar(100) [not null, note: "e.g. Banger, Dinker, "]
  description text
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`]
  updated_at timestamptz [default: `now()`]

  indexes {
    (sport_id, name) [unique]
  }
}

Table play_attributes {
  id uuid [pk, default: `gen_random_uuid()`]
  sport_id uuid [note: "Optional restriction to a sport"]
  name varchar(100) [not null]
  description text
  category varchar(100) [note: "Optional grouping, e.g., Physical, Mental, Tactical"]
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`]
  updated_at timestamptz [default: `now()`]

  indexes {
    (sport_id, name) [unique]
  }
}

Enum match_duration_enum {
  "30"
  "60"
  "90"
  "120"
}

Enum match_type_enum {
  practice
  competitive
  both
}

Enum surface_type_enum {
  hard
  clay
  grass
  synthetic
  carpet
  asphalt
  concrete
}

// ================================
// RATING SYSTEMS (e.g. NTRP, DUPR, UTR)
// ================================
Table rating_systems {
  id uuid [pk, default: `gen_random_uuid()`]
  sport_id uuid [not null]
  code varchar(50) [unique, not null, note: "Short code, e.g. 'NTRP', 'DUPR'"]
  name varchar(150) [not null]
  description text
  min_value numeric(5,2) [not null, note: "Lower bound of the scale (e.g. 1.0)"]
  max_value numeric(5,2) [not null, note: "Upper bound of the scale (e.g. 7.0)"]
  step numeric(5,2) [not null, default: 0.5, note: "Allowed increment step (e.g. 0.5 or 0.1)"]
  default_initial_value numeric(5,2) [note: "Suggested onboarding default"]
  min_for_referral numeric(5,2) [note: "Minimum level at which referrals are encouraged (e.g. 3.0 or 3.5)"]
  
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    code [name: 'idx_rating_system_code']
  }

  note: 'Defines rating/level scales and configuration per sport.'
}

Table rating_scores {
  id uuid [pk, default: `gen_random_uuid()`]
  rating_system_id uuid [not null]
  value float
  label varchar(50) [not null]
  min_value float
  max_value float
  description text
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    (rating_system_id, value) [unique, name: 'uq_rating_score_system_value']
  }
}

Enum rating_certification_method_enum {
  external_rating
  proof
  referrals
}

Table player_rating_scores {
  id uuid [pk, default: `gen_random_uuid()`]
  player_id uuid [not null]
  rating_score_id uuid [not null]

  is_certified boolean [default: false, not null]
  certified_via rating_certification_method_enum
  certified_at timestamptz

  external_rating_score_id uuid
  referrals_count int [default: 0, not null, note: "Number of valid referrals currently held"]
  evaluations_count int [default: 0, not null, note: "Number of evaluations included in computation (e.g. M5 count)"]
  last_evaluated_at timestamptz

  expires_at timestamptz
  source varchar(100)
  notes text

  assigned_at timestamptz [default: `now()`, not null]
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    (player_id, rating_score_id) [unique, name: 'uq_player_rating_score']
    player_id [name: 'idx_player_rating_scores_player']
  }
}

// ================================
// RATING CERTIFICATION
// ================================

Enum file_type_enum {
  image
  video
  document
  audio
  other
}

Enum proof_type_enum {
  external_link   [note: "Link to external rating system or tournament results"]
  file            [note: "Uploaded file (image, video, document)"]
}

Enum proof_status_enum {
  pending         [note: "Awaiting admin review"]
  approved        [note: "Proof accepted as valid"]
  rejected        [note: "Proof rejected by admin"]
}

Enum rating_request_status_enum {
  pending         [note: "Request sent, awaiting response"]
  completed       [note: "Recipient has responded"]
  declined        [note: "Recipient declined to respond"]
  expired         [note: "Request expired without response"]
  cancelled       [note: "Requester cancelled the request"]
}

// Should represent entities like images, videos, documents, ...
// General-purpose file storage for the application
Table files {
  id uuid [pk, default: `gen_random_uuid()`]
  uploaded_by uuid [not null, note: 'User who uploaded the file']
  
  storage_key varchar(500) [not null, unique, note: 'Cloud storage key (S3/Supabase Storage)']
  url text [not null, note: 'Public or signed accessible URL']
  thumbnail_url text [note: 'Thumbnail URL for images/videos']
  
  original_name varchar(255) [not null, note: 'Original file name at upload']
  file_type file_type_enum [not null]
  mime_type varchar(100) [not null, note: 'e.g. image/jpeg, application/pdf']
  file_size bigint [not null, note: 'File size in bytes']
  
  metadata jsonb [default: `'{}'`, note: 'Flexible metadata: dimensions, duration, etc.']
  
  is_deleted boolean [default: false, not null, note: 'Soft delete flag']
  deleted_at timestamptz
  
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    uploaded_by [name: 'idx_files_uploaded_by']
    storage_key [unique, name: 'uq_files_storage_key']
    file_type [name: 'idx_files_file_type']
    is_deleted [name: 'idx_files_is_deleted']
  }

  note: 'General-purpose file storage for images, videos, documents, etc.'
}

// A proof that a player can create in the app to justify his/her declared rating
// Could be an external link, an image, a video recording, or some document like pdf
Table rating_proofs {
  id uuid [pk, default: `gen_random_uuid()`]
  player_rating_score_id uuid [not null, note: 'Which player rating this proof supports']
  
  proof_type proof_type_enum [not null]
  file_id uuid [note: 'Reference to uploaded file (if proof_type = file)']
  external_url text [note: 'External URL (if proof_type = external_link)']
  
  title varchar(255) [not null, note: 'Brief title describing the proof']
  description text [note: 'Detailed description or context']
  
  status proof_status_enum [default: 'pending', not null]
  reviewed_by uuid [note: 'Admin who reviewed the proof']
  reviewed_at timestamptz
  review_notes text [note: 'Admin notes on approval/rejection']
  
  is_active boolean [default: true, not null]
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    player_rating_score_id [name: 'idx_rating_proofs_player_rating_score']
    status [name: 'idx_rating_proofs_status']
    (player_rating_score_id, status) [name: 'idx_rating_proofs_score_status']
  }

  note: 'Proofs uploaded by players to certify their self-declared ratings.'
}

// A request to ask a fellow player to validate (yes or no) the current rating score of the sender
Table rating_reference_requests {
  id uuid [pk, default: `gen_random_uuid()`]
  
  requester_id uuid [not null, note: 'Player requesting the reference']
  player_rating_score_id uuid [not null, note: 'The rating score to be validated']
  referee_id uuid [not null, note: 'Player being asked to validate']
  
  message text [note: 'Optional message from requester to referee']
  
  status rating_request_status_enum [default: 'pending', not null]
  rating_supported boolean [default: false, not null]
  response_message text [note: 'Optional message from referee']
  responded_at timestamptz
  
  expires_at timestamptz [not null, note: 'Request expiration (typically 14 days)']
  
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    requester_id [name: 'idx_rating_ref_requests_requester']
    referee_id [name: 'idx_rating_ref_requests_referee']
    player_rating_score_id [name: 'idx_rating_ref_requests_score']
    status [name: 'idx_rating_ref_requests_status']
    expires_at [name: 'idx_rating_ref_requests_expires']
  }

  note: 'Requests for fellow players to validate (yes/no) a declared rating.'
}

// A request to ask a fellow player to assign a rating score to the sender
Table peer_rating_requests {
  id uuid [pk, default: `gen_random_uuid()`]
  
  requester_id uuid [not null, note: 'Player requesting to be rated']
  evaluator_id uuid [not null, note: 'Player being asked to assign a rating']
  rating_system_id uuid [not null, note: 'Which rating system to use']
  
  message text [note: 'Optional message from requester']
  
  status rating_request_status_enum [default: 'pending', not null]
  assigned_rating_score_id uuid [note: 'Rating score assigned by evaluator']
  response_message text [note: 'Optional comments from evaluator']
  responded_at timestamptz
  
  expires_at timestamptz [not null, note: 'Request expiration (typically 14 days)']
  
  created_at timestamptz [default: `now()`, not null]
  updated_at timestamptz [default: `now()`, not null]

  indexes {
    requester_id [name: 'idx_peer_rating_requests_requester']
    evaluator_id [name: 'idx_peer_rating_requests_evaluator']
    rating_system_id [name: 'idx_peer_rating_requests_system']
    status [name: 'idx_peer_rating_requests_status']
    expires_at [name: 'idx_peer_rating_requests_expires']
    (requester_id, rating_system_id, evaluator_id) [unique, name: 'uq_peer_rating_request']
  }

  note: 'Requests for fellow players to assign a rating score to the requester.'
}

// ================================
// FACILITIES
// ================================
Enum facility_contact_type_enum {
  general
  reservation
  maintenance
  other
}

Enum facility_type_enum {
  municipal
  university
  club
  school
  community_club
  community_center
}

Table facilities {
  id uuid [pk, default: `gen_random_uuid()`]
  organization_id uuid [not null]
  name varchar(255) [not null, note: 'Site name, e.g. Parc Jeanne-Mance']
  facility_type facility_type_enum
  slug varchar(255) [not null, unique, note: 'URL-friendly identifier (consider scoping to organization if you allow same names)']
  description text
  address varchar(255)
  city varchar(100)
  country country_enum
  postal_code varchar(20)
  membership_required boolean [not null, default: false]
  // PostGIS geography point for spatial queries; if PostGIS is not used, keep lat/long columns instead
  location geography(Point,4326) [note: 'Use PostGIS geography for fast geo-queries (lat/lon).']
  latitude decimal(9,6) [note: 'Optional: keep for back-compatibility; populate from location']
  longitude decimal(9,6) [note: 'Optional: keep for back-compatibility; populate from location']
  attributes jsonb [note: 'Flexible: opening_hours, amenities, pricing, accessibility, notes']
  is_active boolean [not null, default: true]
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]
  archived_at timestamptz

  indexes {
    slug [name: 'idx_facilities_slug']
    organization_id [name: 'idx_facilities_org']
    is_active [name: 'idx_facilities_active']
    created_at [name: 'idx_facilities_created_at']
  }

  note: 'Facilities are physical sites with courts; use attributes for extensible metadata.'
}

Table facility_contacts {
  id uuid [pk, default: `gen_random_uuid()`]
  facility_id uuid [not null]
  
  phone varchar(30)
  email varchar(255)
  website varchar(255)
  
  is_primary boolean [not null, default: false, note: 'True if this is the main contact for the facility']
  contact_type facility_contact_type_enum [not null]
  notes text
  attributes jsonb [note: 'Flexible metadata: hours, preferred contact method, languages, etc.']
  sport_id uuid

  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    facility_id [name: 'idx_facility_contacts_facility']
    is_primary [name: 'idx_facility_contacts_primary']
  }

  note: 'Contacts for a facility (general, reservation, sport-specific, etc.). Decoupled from sports for flexibility.'
}

Table facility_images {
  id uuid [pk, default: `gen_random_uuid()`]
  facility_id uuid [not null]
  storage_key varchar(255) [not null, unique, note: 'Stable cloud storage key (S3/Supabase)']
  url text [not null, note: 'Accessible URL (may be signed)']
  thumbnail_url text
  description text
  display_order int [not null, default: 0]
  is_primary boolean [not null, default: false]
  file_size bigint
  mime_type varchar(100)
  metadata jsonb
  uploaded_at timestamptz [not null, default: `now()`]
  created_at timestamptz [not null, default: `now()`]

  indexes {
    facility_id [name: 'idx_facility_images_facility']
    (facility_id, display_order) [name: 'idx_facility_images_order']
    storage_key [unique, name: 'uq_facility_images_storage_key']
  }

  note: 'Images for facilities; use storage_key to dedupe and manage cloud storage lifecycle.'
}

Table facility_files {
  id uuid [pk, default: `gen_random_uuid()`]
  facility_id uuid [not null]
  file_id uuid [not null]
  display_order int [default: 0]
  is_primary boolean [default: false]
}

Table facility_sports {
  id uuid [pk, default: `gen_random_uuid()`]
  facility_id uuid [not null]
  sport_id uuid [not null]
  
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    facility_id [name: 'idx_facility_sports_facility']
    sport_id [name: 'idx_facility_sports_sport']
    (facility_id, sport_id) [unique, name: 'uq_facility_sports_facility_sport']
  }

  note: 'Links facilities to the sports they support. Attributes can hold sport-specific contact or scheduling details.'
}

// ================================
// COURTS
// ================================
Enum availability_enum {
  available
  under_maintenance
  closed
  reserved
}

Table courts {
  id uuid [pk, default: `gen_random_uuid()`]
  facility_id uuid [not null]
  surface_type surface_type_enum
  lighting boolean [not null, default: false]
  indoor boolean [not null, default: false]
  name varchar(100)
  court_number int [note: 'Unique per facility (optional)']
  lines_marked_for_multiple_sports boolean [not null, default: false]
  availability_status availability_enum [not null, default: 'available']
  attributes jsonb [note: 'Court-specific metadata: dimensions, nets, wall height, booking rules']
  notes text
  is_active boolean [not null, default: true]
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    facility_id [name: 'idx_courts_facility']
    availability_status [name: 'idx_courts_availability']
    (facility_id, court_number) [unique, name: 'uq_courts_facility_court_number']
  }

  note: 'Individual courts/rinks/fields within a facility.'
}

// ================================
// COURT SPORTS
// ================================
Table court_sports {
  id uuid [pk, default: `gen_random_uuid()`]
  court_id uuid [not null]
  sport_id uuid [not null]
  
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]

  indexes {
    court_id [name: 'idx_court_sports_court']
    sport_id [name: 'idx_court_sports_sport']
    (court_id, sport_id) [unique, name: 'uq_court_sports_court_sport']
  }

  note: 'Links courts to the sports they support.'
}

// ================================
// USER INVITATIONS
// ================================
Enum invite_source_enum {
  manual [note: "User manually invited"]
  auto_match [note: "Auto-invite from match creation"]
  invite_list [note: "Invite from user's private list"]
  mailing_list [note: "External or system mailing list"]
  growth_prompt [note: "Forced invite on onboarding"]
}

Enum invite_status_enum {
  pending
  sent
  accepted
  expired
  bounced
  cancelled
}

Enum app_role_enum {
  player
  organization_member
  admin
}

Table invitations {
  id uuid [pk, default: `gen_random_uuid()`]
  email varchar(255)
  phone varchar(30)
  token varchar(255) [not null, unique, note: 'Secure random token for invitation link']
  source invite_source_enum [default: 'manual', not null]
  inviter_id uuid [not null]
  invited_user_id uuid [note: 'Set when invitation is accepted']
  organization_id uuid [note: 'If inviting to join an organization']
  role app_role_enum [not null, default: 'player']
  admin_role admin_role_enum
  status invite_status_enum [not null, default: 'pending']
  expires_at timestamptz [not null, note: 'Typically 7 days from creation']
  accepted_at timestamptz
  revoked_at timestamptz
  revoked_by uuid
  revoke_reason text
  metadata jsonb [note: 'Additional context like department, team, etc.']
  created_at timestamptz [not null, default: `now()`]
  updated_at timestamptz [not null, default: `now()`]
  
  indexes {
    token [unique]
    email
    inviter_id
    status
    expires_at
    (email, status)
    (status, expires_at)
  }
  
  Note: 'Stores user invitation requests with expiration and tracking'
}

// ================================
// RELATIONSHIPS WITH CASCADE BEHAVIORS
// ================================

// profiles
Ref: profiles.id > auth_users.id [delete: cascade]

// admins
Ref: admins.id > profiles.id [delete: cascade]

// organizations
Ref: organizations.owner_id > profiles.id [delete: set null]

// organization_members
Ref: organization_members.user_id > profiles.id [delete: cascade]
Ref: organization_members.organization_id > organizations.id [delete: cascade]
Ref: organization_members.invited_by > profiles.id [delete: set null]

// players
Ref: players.id > profiles.id [delete: cascade]

// player_availabilities
Ref: player_availabilities.player_id > players.id [delete: cascade]

// play_styles
Ref: play_styles.sport_id > sports.id [delete: cascade]

// play_attributes
Ref: play_attributes.sport_id > sports.id [delete: set null]

// rating_systems
Ref: rating_systems.sport_id > sports.id [delete: restrict]

// rating_scores
Ref: rating_scores.rating_system_id > rating_systems.id [delete: cascade]

// player_rating_scores
Ref: player_rating_scores.player_id > players.id [delete: cascade]
Ref: player_rating_scores.rating_score_id > rating_scores.id [delete: restrict]
Ref: player_rating_scores.external_rating_score_id > rating_scores.id [delete: set null]

// files
Ref: files.uploaded_by > profiles.id [delete: set null]

// rating_proofs
Ref: rating_proofs.player_rating_score_id > player_rating_scores.id [delete: cascade]
Ref: rating_proofs.file_id > files.id [delete: set null]
Ref: rating_proofs.reviewed_by > profiles.id [delete: set null]

// rating_reference_requests
Ref: rating_reference_requests.requester_id > players.id [delete: cascade]
Ref: rating_reference_requests.player_rating_score_id > player_rating_scores.id [delete: cascade]
Ref: rating_reference_requests.referee_id > players.id [delete: cascade]

// peer_rating_requests
Ref: peer_rating_requests.requester_id > players.id [delete: cascade]
Ref: peer_rating_requests.evaluator_id > players.id [delete: cascade]
Ref: peer_rating_requests.rating_system_id > rating_systems.id [delete: restrict]
Ref: peer_rating_requests.assigned_rating_score_id > rating_scores.id [delete: set null]

// facilities
Ref: facilities.organization_id > organizations.id [delete: cascade]

// facility_contacts
Ref: facility_contacts.facility_id > facilities.id [delete: cascade]
Ref: facility_contacts.sport_id > sports.id [delete: set null]

// facility_images
Ref: facility_images.facility_id > facilities.id [delete: cascade]

// facility_files
Ref: facility_files.facility_id > facilities.id [delete: cascade]
Ref: facility_files.file_id > files.id [delete: cascade]

// facility_sports
Ref: facility_sports.facility_id > facilities.id [delete: cascade]
Ref: facility_sports.sport_id > sports.id [delete: restrict]

// courts
Ref: courts.facility_id > facilities.id [delete: cascade]

// court_sports
Ref: court_sports.court_id > courts.id [delete: cascade]
Ref: court_sports.sport_id > sports.id [delete: restrict]

// invitations
Ref: invitations.inviter_id > profiles.id [delete: set null]
Ref: invitations.invited_user_id > profiles.id [delete: set null]
Ref: invitations.organization_id > organizations.id [delete: cascade]
Ref: invitations.revoked_by > profiles.id [delete: set null]
